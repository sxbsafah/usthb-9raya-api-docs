openapi: 3.0.3
info:
  title: USTHB Hub API
  version: 1.0.0
servers:
  - url: http://localhost:3000
    description: Local
  - url: https://api.example.com
    description: Production
tags:
  - name: Authentication
  - name: Faculties
  - name: Modules
  - name: SubModules
  - name: Contributions
paths:
  /auth/:
    get:
      tags: [Authentication]
      summary: Auth router health
      responses:
        "200": { description: OK }
  /auth/register:
    post:
      tags: [Authentication]
      summary: Register
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [username, email, firstName, lastName, password]
              properties:
                username: { type: string, minLength: 3, maxLength: 20 }
                email: { type: string, format: email }
                firstName: { type: string, minLength: 2, maxLength: 30 }
                lastName: { type: string, minLength: 2, maxLength: 30 }
                password: { type: string, minLength: 6 }
      responses:
        "201": { description: Created }
        "400": { description: Validation error }
        "409": { description: Conflict }
  /auth/login:
    post:
      tags: [Authentication]
      summary: Login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [password]
              properties:
                email: { type: string, format: email }
                username: { type: string }
                password: { type: string }
      responses:
        "200": { description: OK }
        "400": { description: Validation error }
        "401": { description: Unauthorized }
  /auth/logout:
    get:
      tags: [Authentication]
      summary: Logout
      security: [{ bearerAuth: [] }]
      responses:
        "200": { description: OK }
        "401": { description: Unauthorized }
  /faculties/:
    get:
      tags: [Faculties]
      summary: List faculties
      responses:
        "200": { description: OK }
    post:
      tags: [Faculties]
      summary: Create faculty
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name]
              properties:
                name: { type: string, minLength: 2, maxLength: 100 }
      responses:
        "201": { description: Created }
        "400": { description: Validation error }
        "401": { description: Unauthorized }
        "409": { description: Conflict }
  /faculties/{id}:
    parameters:
      - in: path
        name: id
        required: true
        schema: { type: string }
    get:
      tags: [Faculties]
      summary: Get faculty by id
      responses:
        "200": { description: OK }
        "400": { description: Validation error }
        "404": { description: Not found }
    put:
      tags: [Faculties]
      summary: Update faculty
      security: [{ bearerAuth: [] }]
      responses:
        "200": { description: OK }
        "400": { description: Validation error }
        "401": { description: Unauthorized }
        "404": { description: Not found }
    delete:
      tags: [Faculties]
      summary: Delete faculty
      security: [{ bearerAuth: [] }]
      responses:
        "200": { description: OK }
        "400": { description: Validation error }
        "401": { description: Unauthorized }
        "404": { description: Not found }
  /modules/:
    get:
      tags: [Modules]
      summary: List modules
      responses:
        "200": { description: OK }
    post:
      tags: [Modules]
      summary: Create module
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, facultyId]
              properties:
                name: { type: string, minLength: 2, maxLength: 100 }
                facultyId: { type: string }
      responses:
        "201": { description: Created }
        "400": { description: Validation error }
        "401": { description: Unauthorized }
        "404": { description: Faculty not found }
        "409": { description: Conflict }
  /modules/faculty/{facultyId}:
    parameters:
      - in: path
        name: facultyId
        required: true
        schema: { type: string }
    get:
      tags: [Modules]
      summary: List modules by faculty
      responses:
        "200": { description: OK }
        "400": { description: Validation error }
        "404": { description: Not found }
  /modules/{id}:
    parameters:
      - in: path
        name: id
        required: true
        schema: { type: string }
    get:
      tags: [Modules]
      summary: Get module by id
      responses:
        "200": { description: OK }
        "400": { description: Validation error }
        "404": { description: Not found }
    put:
      tags: [Modules]
      summary: Update module
      security: [{ bearerAuth: [] }]
      responses:
        "200": { description: OK }
        "400": { description: Validation error }
        "401": { description: Unauthorized }
        "404": { description: Not found }
    delete:
      tags: [Modules]
      summary: Delete module
      security: [{ bearerAuth: [] }]
      responses:
        "200": { description: OK }
        "400": { description: Validation error }
        "401": { description: Unauthorized }
        "404": { description: Not found }
  /submodules/:
    get:
      tags: [SubModules]
      summary: List submodules
      responses:
        "200": { description: OK }
    post:
      tags: [SubModules]
      summary: Create submodule
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, moduleId]
              properties:
                name: { type: string, minLength: 2, maxLength: 100 }
                moduleId: { type: string }
      responses:
        "201": { description: Created }
        "400": { description: Validation error }
        "401": { description: Unauthorized }
        "404": { description: Module not found }
        "409": { description: Conflict }
  /submodules/module/{moduleId}:
    parameters:
      - in: path
        name: moduleId
        required: true
        schema: { type: string }
    get:
      tags: [SubModules]
      summary: List submodules by module
      responses:
        "200": { description: OK }
        "400": { description: Validation error }
        "404": { description: Not found }
  /submodules/{id}:
    parameters:
      - in: path
        name: id
        required: true
        schema: { type: string }
    get:
      tags: [SubModules]
      summary: Get submodule by id
      responses:
        "200": { description: OK }
        "400": { description: Validation error }
        "404": { description: Not found }
    put:
      tags: [SubModules]
      summary: Update submodule
      security: [{ bearerAuth: [] }]
      responses:
        "200": { description: OK }
        "400": { description: Validation error }
        "401": { description: Unauthorized }
        "404": { description: Not found }
    delete:
      tags: [SubModules]
      summary: Delete submodule
      security: [{ bearerAuth: [] }]
      responses:
        "200": { description: OK }
        "400": { description: Validation error }
        "401": { description: Unauthorized }
        "404": { description: Not found }
  /contributions/:
    get:
      tags: [Contributions]
      summary: List contributions
      responses:
        "200": { description: OK }
    post:
      tags: [Contributions]
      summary: Create contribution
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required: [description]
              properties:
                description: { type: string, minLength: 10, maxLength: 500 }
                files:
                  type: array
                  items:
                    type: string
                    format: binary
      responses:
        "201": { description: Created }
        "400": { description: Validation error }
        "401": { description: Unauthorized }
        "413": { description: Payload too large }
        "415": { description: Unsupported media type }
  /contributions/my/all:
    get:
      tags: [Contributions]
      summary: List my contributions
      security: [{ bearerAuth: [] }]
      responses:
        "200": { description: OK }
        "401": { description: Unauthorized }
  /contributions/pending:
    get:
      tags: [Contributions]
      summary: List pending contributions
      security: [{ bearerAuth: [] }]
      responses:
        "200": { description: OK }
        "401": { description: Unauthorized }
        "403": { description: Forbidden }
  /contributions/{id}:
    parameters:
      - in: path
        name: id
        required: true
        schema: { type: string }
    get:
      tags: [Contributions]
      summary: Get contribution by id
      responses:
        "200": { description: OK }
        "400": { description: Validation error }
        "404": { description: Not found }
    put:
      tags: [Contributions]
      summary: Update contribution
      security: [{ bearerAuth: [] }]
      requestBody:
        required: false
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                files:
                  type: array
                  items:
                    type: string
                    format: binary
      responses:
        "200": { description: OK }
        "400": { description: Validation error }
        "401": { description: Unauthorized }
        "404": { description: Not found }
        "413": { description: Payload too large }
        "415": { description: Unsupported media type }
    delete:
      tags: [Contributions]
      summary: Delete contribution
      security: [{ bearerAuth: [] }]
      responses:
        "200": { description: OK }
        "400": { description: Validation error }
        "401": { description: Unauthorized }
        "404": { description: Not found }
  /contributions/{id}/resources:
    parameters:
      - in: path
        name: id
        required: true
        schema: { type: string }
    get:
      tags: [Contributions]
      summary: List resources for a contribution
      responses:
        "200": { description: OK }
        "400": { description: Validation error }
        "404": { description: Not found }
  /contributions/resources/all:
    get:
      tags: [Contributions]
    summary: List all resources
    responses:
      "200": { description: OK }
  /contributions/resources/user/{userId}:
    parameters:
      - in: path
        name: userId
        required: true
        schema: { type: string }
    get:
      tags: [Contributions]
      summary: List resources by user
      responses:
        "200": { description: OK }
        "404": { description: Not found }
  /contributions/resources/my:
    get:
      tags: [Contributions]
      summary: List my resources
      security: [{ bearerAuth: [] }]
      responses:
        "200": { description: OK }
        "401": { description: Unauthorized }
  /contributions/resource/{resourceId}:
    parameters:
      - in: path
        name: resourceId
        required: true
        schema: { type: string }
    put:
      tags: [Contributions]
      summary: Update a single resource file
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required: [file]
              properties:
                file:
                  type: string
                  format: binary
      responses:
        "200": { description: OK }
        "400": { description: Validation error }
        "401": { description: Unauthorized }
        "404": { description: Not found }
        "413": { description: Payload too large }
        "415": { description: Unsupported media type }
  /contributions/resource/{resourceId}/status:
    parameters:
      - in: path
        name: resourceId
        required: true
        schema: { type: string }
    patch:
      tags: [Contributions]
      summary: Update resource status
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [status]
              properties:
                status:
                  type: string
                  enum: [approved, rejected]
      responses:
        "200": { description: OK }
        "400": { description: Validation error }
        "401": { description: Unauthorized }
        "403": { description: Forbidden }
        "404": { description: Not found }
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
